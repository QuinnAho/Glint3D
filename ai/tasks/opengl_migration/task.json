{
  "id": "opengl_migration",
  "title": "Complete OpenGL to RHI Migration",
  "owner": "rhi_abstraction_team",
  "status": "in_progress",
  "completion_percentage": 95,
  "inputs": {
    "files": [
      "engine/src/render_system.cpp (146 OpenGL calls - COMPLETED)",
      "engine/src/axisrenderer.cpp (26 OpenGL calls - COMPLETED)",
      "engine/src/grid.cpp (10 OpenGL calls - COMPLETED)",
      "engine/src/gizmo.cpp (0 OpenGL calls - COMPLETED)",
      "engine/src/light.cpp (76 OpenGL calls - COMPLETED)",
      "engine/src/skybox.cpp (0 OpenGL calls - COMPLETED)",
      "engine/src/ibl_system.cpp (129 OpenGL calls - 81 ELIMINATED, 48 REMAINING IN PHASES 3-5)",
      "engine/src/texture.cpp (18 OpenGL calls - COMPLETED)",
      "engine/src/texture_cache.cpp (COMPLETED)",
      "engine/src/application_core.cpp (glClear direct GL)",
      "engine/include/glint3d/rhi.h",
      "engine/src/rhi/rhi_gl.cpp"
    ],
    "schema_version": "rhi_v1"
  },
  "outputs": {
    "artifacts": [
      "Zero direct OpenGL calls in render_system.cpp ✓",
      "RHI framebuffer abstraction ✓",
      "RHI rendering state management ✓",
      "RHI resource management layer ✓",
      "RHI screen-quad utility ✓",
      "AxisRenderer uses RHI ✓",
      "Grid uses RHI ✓",
      "Gizmo uses RHI ✓",
      "Skybox uses RHI ✓",
      "Light uses RHI ✓",
      "IBLSystem infrastructure uses RHI ✓ (generation deferred to Phase 3)",
      "Texture creation via RHI ✓",
      "TextureCache uses RHI ✓",
      "Application loop uses RHI clear (pending)",
      "All setUniform* calls removed (pending)"
    ],
    "events": [
      "opengl_call_audit",
      "rhi_migration_progress",
      "render_system_complete",
      "helper_systems_migration",
      "validation_success",
      "migration_complete"
    ]
  },
  "acceptance": [
    "grep -r 'gl[A-Z]' engine/src/*.cpp (excluding glad/ImGui) returns zero matches",
    "AxisRenderer, Grid, Gizmo, Skybox use RHI for all rendering ✓",
    "Texture class uses RHI::createTexture/updateTexture",
    "Light indicator rendering uses RHI ✓",
    "Application loop uses m_rhi->clear() not glClear() ✓",
    "All RenderSystem setUniform* calls replaced with manager APIs",
    "Legacy RhiGL::setUniform* helpers removed",
    "Full backend swap test: Can switch to stub backend without GL dependencies"
  ],
  "phases": [
    {
      "name": "render_system_migration",
      "status": "completed",
      "gl_calls_eliminated": 146,
      "completion_date": "2025-01-15"
    },
    {
      "name": "helper_systems_migration",
      "status": "in_progress",
      "systems_completed": ["AxisRenderer", "Grid", "Gizmo", "Skybox", "Light"],
      "systems_partial": ["IBLSystem (infrastructure complete, generation deferred)"],
      "systems_remaining": [],
      "gl_calls_eliminated": 168,
      "ibl_partial_breakdown": "56 eliminated, 73 deferred to Phase 3",
      "estimated_remaining_calls": 0,
      "completion_date": "2025-10-02",
      "note": "Phase 2 infrastructure complete; IBL generation requires Phase 3 RHI extensions"
    },
    {
      "name": "texture_system_migration",
      "status": "completed",
      "systems_completed": ["Texture", "TextureCache"],
      "gl_calls_eliminated": 18,
      "completion_date": "2025-10-02",
      "note": "RHI-only migration, zero GL calls remaining"
    },
    {
      "name": "application_loop_migration",
      "status": "completed",
      "systems": ["ApplicationCore"],
      "gl_calls_eliminated": 2,
      "gl_calls_remaining": 0,
      "completion_date": "2025-10-03",
      "note": "RHI-only implementation, zero GL calls remaining"
    },
    {
      "name": "ibl_cubemap_generation",
      "status": "completed",
      "estimated_effort_hours": "16-23",
      "actual_effort_hours": "~3",
      "phases_completed": ["Phase 1: RHI Extensions", "Phase 2: Environment Map Migration", "Phase 3: Irradiance Map", "Phase 4: Prefilter Map", "Phase 5: BRDF LUT"],
      "phases_remaining": ["Phase 6: Legacy Shader Removal (deferred)", "Phase 7: Validation"],
      "gl_calls_eliminated": 92,
      "gl_calls_remaining": 0,
      "dependencies": ["RHI cubemap texture support (DONE)", "RHI cubemap face attachment (DONE)", "RHI mipmap generation (DONE)"],
      "plan_document": "ai/tasks/opengl_migration/artifacts/ibl_cubemap_rhi_implementation_plan.md",
      "note": "Phases 1-5 complete, all IBL generation methods now 100% RHI-based, zero GL calls remaining in ibl_system.cpp",
      "completion_date": "2025-10-05"
    },
    {
      "name": "final_cleanup",
      "status": "pending",
      "tasks": ["Remove setUniform* helpers (60+ call sites)", "Remove legacy Shader class (22 GL calls)", "Backend swap validation"]
    }
  ],
  "safety": {
    "rate_limits": ["max_build_attempts_10_per_hour"],
    "sandbox": false
  },
  "dependencies": ["core_decomposition"],
  "seed_policy": "not_applicable"
}